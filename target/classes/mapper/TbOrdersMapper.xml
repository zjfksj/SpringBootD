<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.zj.mapper.TbOrdersMapper" >
  <resultMap id="BaseResultMap" type="com.zj.entity.TbOrders" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Wed May 29 11:16:27 CST 2019.
    -->
    <id column="orders_no" property="ordersNo" jdbcType="INTEGER" />
    <result column="Cbename" property="cbename" jdbcType="VARCHAR" />
    <result column="cbecodeinsp" property="cbecodeinsp" jdbcType="VARCHAR" />
    <result column="Goods_number" property="goodsNumber" jdbcType="INTEGER" />
    <result column="User_name" property="userName" jdbcType="VARCHAR" />
    <result column="Total_Money" property="totalMoney" jdbcType="REAL" />
    <result column="Create_Time" property="createTime" jdbcType="TIMESTAMP" />
    <association property="tbOrdersdetails" javaType="com.zj.entity.TbOrdersdetails">
		<id column="ordersDetails_no" property="ordersdetailsNo" />
    	<result column="orders_no" property="ordersNo"  />
    	<result column="Goods_no" property="goodsNo" />
    	<result column="Goods_name" property="goodsName" /> 
    	<result column="Goodsinsp" property="goodsinsp" />
    	<result column="Goods_price" property="goodsPrice"/>
    	<result column="Goods_number" property="goodsNumber"/>
    	<result column="Total" property="total" jdbcType="REAL" />
    	<result column="Create_Time" property="createTime"/>
	</association>
  </resultMap>
  <select id="findUserByPage1" resultMap="BaseResultMap">
  		select  a.*,GROUP_CONCAT(b.Goods_name SEPARATOR ',') Goods_name ,GROUP_CONCAT(b.Goods_no SEPARATOR ',') Goods_no ,
		GROUP_CONCAT(b.Goods_price SEPARATOR ',') Goods_price 
		from tb_orders a,tb_ordersdetails b where a.Orders_no=b.Orders_no 
        <if test="username!=null and username !=''">
           and a.orders_no LIKE concat(concat('%',#{username}),'%') 
        </if>
        <if test="accurate!=null and accurate !=''">
           and a.orders_no=#{accurate}
        </if>
        GROUP BY a.Orders_no
        limit #{0},#{1}
  </select>
   <select id="soucount1" resultType="int">
   		select count(a.orders_no) 
        from tb_orders a,tb_ordersdetails b where a.Orders_no=b.Orders_no
        <if test="username!=null and username !=''">
           and a.orders_no LIKE concat(concat('%',#{username}),'%') 
        </if>
        <if test="accurate!=null and accurate !=''">
           and a.orders_no=#{accurate}
        </if>
   </select>
</mapper>